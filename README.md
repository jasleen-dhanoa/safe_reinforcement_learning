Previous version of CAP we wrote ourselves from scratch
